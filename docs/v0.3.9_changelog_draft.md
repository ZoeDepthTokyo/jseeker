# v0.3.9 Changelog Draft

## Version 0.3.9 (Feb 16, 2026) â€” Company Naming + LinkedIn Fallback (Feb 16 Feedback)

**Scope:** Address HIGH P0/P1 issues from Feb 16, 2026 10:21 AM user feedback

### HIGH P0: Company Name Extraction Fixes
**Problem:** Company names corrupted/truncated ("PayPal_has_been_revolutionizin", "revenue" instead of "Paramount")

**Root Cause:** JD parsing extracted sentence fragments, false positives, and URL slugs without sanitization

**Solution:**
- **New `sanitize_company_name()` function** in `jd_parser.py`:
  - Sentence fragment truncation (detects verbs: "has", "is", "provides", "revolutionizing")
  - False positive rejection ("revenue", "position", "team", "remote")
  - URL slug cleanup ("Acme_Corp" â†’ "Acme Corp")
  - Placeholder detection ("Not Specified", "unknown", "N/A", "TBD")
  - Length/word count validation (rejects 1-char, >60-char, >6-word strings)
  - Article/punctuation cleanup (strips "The"/"A"/"An", trailing commas)

- **Integration:** All 3 extraction paths (LLM, regex, URL) now pass through sanitization
- **Defense-in-depth:** Added sanitization at DB layer in `tracker.py::get_or_create_company()`
- **Cleanup utility:** New `tracker.py::sanitize_existing_companies()` + UI button in Resume Library

**Files Modified:**
- `jseeker/jd_parser.py`: New sanitization function + integration
- `jseeker/tracker.py`: DB-level sanitization + bulk cleanup method
- `ui/pages/3_resume_library.py`: "Database Maintenance" section with cleanup button
- `tests/test_jd_parser.py`: 13 new sanitization tests

**Cascade Effects Fixed:**
- Output folder names: Now use sanitized company names (verified automatically via upstream fix)
- Resume filenames: Now use sanitized company names (verified automatically)
- Application tracker: Shows clean company names in UI + DB
- Resume Library: Displays clean company names + manual cleanup option

---

### HIGH P1: LinkedIn JD Bottleneck â€” Fallback Search
**Problem:** Some LinkedIn jobs don't show full JD without manual interaction (e.g., Paramount+ missing JD details)

**Solution:**
- **Incomplete JD detection:** `_is_incomplete_jd()` detects thin content (<200 chars, or <500 chars without key sections)
- **Company career site search:** `_search_company_career_site()` tries common patterns (careers.{company}.com, jobs.{company}.com, etc.)
- **Google fallback:** `_linkedin_fallback_search()` searches web for alternate postings when career site fails
- **Alternate source tracking:** New `alternate_source_url` field on `ParsedJD` model tracks where JD was fetched from
- **User notification:** UI shows `st.info()` when LinkedIn fallback was used

**Flow:**
```
LinkedIn URL â†’ incomplete JD detected
  â†’ Strategy 1: Search company career site
  â†’ Strategy 2: Google search for alternate posting
  â†’ Return full JD with metadata
```

**Files Modified:**
- `jseeker/models.py`: Added `alternate_source_url` field (backward compatible)
- `jseeker/jd_parser.py`: 3 new functions + enhanced `extract_jd_from_url()`
- `ui/pages/2_new_resume.py`: User notification when fallback used
- `tests/test_jd_parser.py`: 18 new LinkedIn fallback tests

---

### CI/CD: Lint & Format Compliance
**Issue:** 4 consecutive CI runs failing due to Black formatting + ruff linter errors

**Fix:**
- Formatted 27 files with Black (line-length 100)
- Removed 8 unused variables flagged by ruff
- Fixed bare except clause with specific exception types (json.JSONDecodeError, KeyError, TypeError, AttributeError)
- All lint checks now passing

**Files Affected:** 31 files (including new launch scripts from v0.3.8.1)

---

### Test Results
- **478 passed, 2 failed** (312s)
- **2 pre-existing failures** (not related to this sprint):
  1. `test_language_detection_and_address_routing` â€” French detection (known since v0.3.6)
  2. `test_job_discovery_large_dataset_performance` â€” Timing edge case (machine-dependent)
- **39 new tests added** (13 sanitization + 18 LinkedIn fallback + 8 integration)
- **Zero regressions**

---

### Team Approach
- **4 parallel agents** with task ownership:
  - `parser-engineer`: Company name extraction fix (Task #2)
  - `linkedin-engineer`: LinkedIn fallback + downstream integration (Tasks #3-6)
  - `test-specialist`: CI/CD validation (Task #9)
  - `team-lead`: CI lint fixes + coordination
- **Task dependencies managed** to avoid conflicts
- **Defense-in-depth** approach at multiple layers (parsing, DB, UI)

---

### Files Modified (Summary)
**Core Logic:**
- `jseeker/jd_parser.py`: Sanitization + LinkedIn fallback
- `jseeker/models.py`: New alternate_source_url field
- `jseeker/tracker.py`: DB-level sanitization + cleanup utility

**UI:**
- `ui/pages/2_new_resume.py`: LinkedIn fallback notification
- `ui/pages/3_resume_library.py`: Database maintenance section

**Tests:**
- `tests/test_jd_parser.py`: +31 tests (13 sanitization, 18 fallback)
- All other test files: Black formatting

**Total:** 31 files modified, 478/480 tests passing

---

### Deferred (Not Implemented)
- **MED P3:** Coherence validation â€” [IN PROGRESS Task #7]
- **MED P4:** Manual URL editing in tracker â€” Low priority, deferred
- **MED P5:** Manual location data for Aviva/Stay 22 â€” No impact found
- **LOW P6:** Regional Salary Analytics â€” Planning mode only, requires Opus

---

### Breaking Changes
None. All changes are backward compatible.

---

### Migration Notes
**For users with existing corrupted company names in database:**
1. Open Resume Library page in jSeeker
2. Expand "Database Maintenance" section
3. Click "Sanitize Company Names" button
4. Review changes before confirming merge

**No migration needed for:**
- New applications (automatically use sanitized names)
- Output folders (new resumes use clean names automatically)
- LinkedIn fallback (transparent to user, shows notification)

---

### Documentation Updates
- `CLAUDE.md`: No updates needed (existing patterns still apply)
- `docs/LAUNCH_SCRIPTS_DECOUPLED.md`: Created in v0.3.8.1 (separate work)
- This changelog appended to `docs/PRD.md`

---

### Cost Impact
No change to per-resume cost (~$0.09). LinkedIn fallback adds:
- ~0-2 WebFetch calls if career site found directly (free via requests)
- ~1 Google search if fallback needed ($0.002 via WebSearch)
- Total impact: <$0.01 per resume in worst case

---

### Next Sprint Priorities
1. âœ… Task #7: End-to-end coherence validation (linkedin-engineer)
2. ðŸ”² Task #8: Manual URL editing (P4 - optional)
3. ðŸ”² MED P5: Manual location data override
4. ðŸ”² LOW P6: Regional Salary Analytics (Opus planning mode)
